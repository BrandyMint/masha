# –°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–Ω–æ–ø–∫–∏ "–ó–∞–∫—Ä—ã—Ç—å" –≤ –º–µ–Ω—é –ø—Ä–æ–µ–∫—Ç–æ–≤

## 1. –ê–Ω–∞–ª–∏–∑ —Ç–µ–∫—É—â–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### 1.1. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –º–µ–Ω—é –ø—Ä–æ–µ–∫—Ç–æ–≤ (`show_projects_list`)

–¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –≤ `app/commands/projects_command.rb` —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç inline keyboard:
- **–†—è–¥ 1**: –ö–Ω–æ–ø–∫–∞ "‚ûï –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–µ–∫—Ç" (–Ω–∞ –≤—Å—é —à–∏—Ä–∏–Ω—É)
- **–†—è–¥—ã 2-N**: –ü—Ä–æ–µ–∫—Ç—ã –≥—Ä—É–ø–ø–∞–º–∏ –ø–æ 3 –∫–Ω–æ–ø–∫–∏ –≤ —Ä—è–¥—É (callback: `projects_select:slug`)
- **–û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç**: –ö–Ω–æ–ø–∫–∞ –∑–∞–∫—Ä—ã—Ç–∏—è/—Å–∫—Ä—ã—Ç–∏—è –º–µ–Ω—é

### 1.2. Callback —Å–∏—Å—Ç–µ–º–∞

–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —á–µ—Ä–µ–∑ –º–µ—Ç–æ–¥—ã —Å –ø–∞—Ç—Ç–µ—Ä–Ω–æ–º `{action}_callback_query`, –Ω–∞–ø—Ä–∏–º–µ—Ä:
- `projects_create_callback_query` ‚Üí `projects_create:`
- `projects_select_callback_query` ‚Üí `projects_select:slug`
- `projects_list_callback_query` ‚Üí `projects_list:`

### 1.3. –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã —Å–∫—Ä—ã—Ç–∏—è

–í –¥—Ä—É–≥–∏—Ö –∫–æ–º–∞–Ω–¥–∞—Ö (–Ω–∞–ø—Ä–∏–º–µ—Ä, `/edit`) –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π** —Å –∏–∑–º–µ–Ω–µ–Ω–∏–µ–º —Ç–µ–∫—Å—Ç–∞ –∏ –æ—á–∏—Å—Ç–∫–æ–π –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã. –û–¥–Ω–∞–∫–æ –¥–ª—è `/projects` –±–æ–ª–µ–µ —É–º–µ—Å—Ç–Ω–æ **–ø–æ–ª–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è**.

---

## 2. –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏

### 2.1. –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

| ID | –¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç |
|----|------------|-----------|
| FR-1 | –î–æ–±–∞–≤–∏—Ç—å –∫–Ω–æ–ø–∫—É "‚ùå –ó–∞–∫—Ä—ã—Ç—å" –≤ –Ω–∏–∂–Ω–µ–π —á–∞—Å—Ç–∏ inline keyboard | –í—ã—Å–æ–∫–∏–π |
| FR-2 | –ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –∫–Ω–æ–ø–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –º–µ–Ω—é –¥–æ–ª–∂–Ω–æ —É–¥–∞–ª—è—Ç—å—Å—è | –í—ã—Å–æ–∫–∏–π |
| FR-3 | –ö–Ω–æ–ø–∫–∞ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤ –≥–ª–∞–≤–Ω–æ–º –º–µ–Ω—é —Å–ø–∏—Å–∫–∞ –ø—Ä–æ–µ–∫—Ç–æ–≤ | –°—Ä–µ–¥–Ω–∏–π |
| FR-4 | –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∏–Ω—Ç–µ—Ä–Ω–∞—Ü–∏–æ–Ω–∞–ª–∏–∑–∞—Ü–∏–∏ (i18n) | –í—ã—Å–æ–∫–∏–π |

### 2.2. –ù–µ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

| ID | –¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ | –ú–µ—Ç—Ä–∏–∫–∞ |
|----|------------|---------|
| NFR-1 | –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π | 100% –ø–æ–∫—Ä—ã—Ç–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ |
| NFR-2 | –í—Ä–µ–º—è –æ—Ç–∫–ª–∏–∫–∞ | < 1 —Å–µ–∫—É–Ω–¥—ã |
| NFR-3 | –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ API | Graceful degradation |
| NFR-4 | –ú–∏–Ω–∏–º—É–º –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ –∫–æ–¥–µ | < 10 —Å—Ç—Ä–æ–∫ |

---

## 3. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –æ–ø—ã—Ç (UX)

### 3.1. –¢–µ–∫—É—â–∏–π –ø–æ—Ç–æ–∫ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è

```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: /projects
[–ü–æ—è–≤–ª—è–µ—Ç—Å—è –º–µ–Ω—é —Å–æ —Å–ø–∏—Å–∫–æ–º –ø—Ä–æ–µ–∫—Ç–æ–≤]
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: [–≤—ã–Ω—É–∂–¥–µ–Ω –≤—Ä—É—á–Ω—É—é —É–¥–∞–ª—è—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ]
```

### 3.2. –ù–æ–≤—ã–π –ø–æ—Ç–æ–∫ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è

```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: /projects
[–ü–æ—è–≤–ª—è–µ—Ç—Å—è –º–µ–Ω—é —Å–æ —Å–ø–∏—Å–∫–æ–º –ø—Ä–æ–µ–∫—Ç–æ–≤ –∏ –∫–Ω–æ–ø–∫–æ–π "‚ùå –ó–∞–∫—Ä—ã—Ç—å"]
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: –ù–∞–∂–∏–º–∞–µ—Ç "‚ùå –ó–∞–∫—Ä—ã—Ç—å"
[–°–æ–æ–±—â–µ–Ω–∏–µ —É–¥–∞–ª—è–µ—Ç—Å—è, —á–∞—Ç –æ—Å—Ç–∞–µ—Ç—Å—è —á–∏—Å—Ç—ã–º]
```

### 3.3. –ú–∞–∫–µ—Ç –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã

**–î–æ:**
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  ‚ûï –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–µ–∫—Ç      ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ proj1   ‚îÇ proj2   ‚îÇ ... ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ proj4   ‚îÇ proj5   ‚îÇ ... ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**–ü–æ—Å–ª–µ:**
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  ‚ûï –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–µ–∫—Ç      ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ proj1   ‚îÇ proj2   ‚îÇ ... ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ proj4   ‚îÇ proj5   ‚îÇ ... ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  ‚ùå –ó–∞–∫—Ä—ã—Ç—å             ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## 4. –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è

### 4.1. –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ `app/commands/projects_command.rb`

#### 4.1.1. –ù–æ–≤—ã–π –º–µ—Ç–æ–¥ callback (—Å—Ç—Ä–æ–∫–∞ ~52)

```ruby
def projects_close_callback_query(_data = nil)
  message = callback_query.message
  bot.delete_message(
    chat_id: message.chat.id,
    message_id: message.message_id
  )
rescue Telegram::Bot::Exceptions::ResponseError => e
  # –ï—Å–ª–∏ –Ω–µ —É–¥–∞–ª–æ—Å—å —É–¥–∞–ª–∏—Ç—å (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å—Ç–∞—Ä–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ), —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º
  Rails.logger.warn "Failed to delete projects menu: #{e.message}"
  edit_message :text,
               text: "üìã –ú–µ–Ω—é –ø—Ä–æ–µ–∫—Ç–æ–≤ –∑–∞–∫—Ä—ã—Ç–æ",
               reply_markup: { inline_keyboard: [] }
end
```

#### 4.1.2. –ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è `show_projects_list` (—Å—Ç—Ä–æ–∫–∏ ~385-386)

```ruby
# –î–æ–±–∞–≤–ª—è–µ–º –∫–Ω–æ–ø–∫—É "–ó–∞–∫—Ä—ã—Ç—å" –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–π —Å—Ç—Ä–æ–∫–µ
buttons << [{ text: t('commands.projects.close_button'), callback_data: 'projects_close:' }]

respond_with :message, text: t('commands.projects.title'), reply_markup: {
  inline_keyboard: buttons
}
```

### 4.2. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–µ—Ä–µ–≤–æ–¥–æ–≤ (`config/locales/ru.yml`)

```yaml
# –í —Å–µ–∫—Ü–∏—é commands/projects –¥–æ–±–∞–≤–∏—Ç—å:
projects:
  title: "–ß—Ç–æ –±—É–¥–µ–º –¥–µ–ª–∞—Ç—å —Å –ø—Ä–æ–µ–∫—Ç–∞–º–∏?"
  add_button: "‚ûï –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–µ–∫—Ç"
  close_button: "‚ùå –ó–∞–∫—Ä—ã—Ç—å"  # <=== –ù–û–í–ê–Ø –°–¢–†–û–ö–ê
  cancel_button: "‚ùå –û—Ç–º–µ–Ω–∞"
  # ... –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–≤–æ–¥—ã
```

### 4.3. –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

```ruby
# –í —Å–ª—É—á–∞–µ –µ—Å–ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å–ª–∏—à–∫–æ–º —Å—Ç–∞—Ä–æ–µ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è (>48 —á–∞—Å–æ–≤)
# –∏–ª–∏ –¥—Ä—É–≥–∏–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è Telegram API
rescue Telegram::Bot::Exceptions::ResponseError => e
  if e.message.include?('message to delete not found')
    edit_message :text,
                 text: "üìã –ú–µ–Ω—é –ø—Ä–æ–µ–∫—Ç–æ–≤ –∑–∞–∫—Ä—ã—Ç–æ",
                 reply_markup: { inline_keyboard: [] }
  else
    raise # –ü—Ä–æ–±—Ä–∞—Å—ã–≤–∞–µ–º –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω—ã–µ –æ—à–∏–±–∫–∏
  end
end
```

---

## 5. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### 5.1. –¢–µ—Å—Ç–æ–≤—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π (RSpec)

**–§–∞–π–ª**: `spec/controllers/telegram/webhook/projects_command_spec.rb`

```ruby
context 'close menu functionality', :callback_query do
  let(:user) { users(:user_with_telegram) }
  let(:telegram_user) { telegram_users(:telegram_regular) }
  let(:from_id) { telegram_user.id }

  include_context 'authenticated user'

  it 'deletes message when close button is clicked' do
    # 1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –º–µ–Ω—é –ø—Ä–æ–µ–∫—Ç–æ–≤
    dispatch_command :projects

    # 2. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç "–ó–∞–∫—Ä—ã—Ç—å"
    expect {
      dispatch(callback_query: {
                 id: 'test_callback',
                 from: from,
                 message: { message_id: 22, chat: chat },
                 data: "projects_close:"
               })
    }.to delete_telegram_message(chat_id: chat[:id], message_id: 22)
  end

  it 'displays close button in projects list' do
    response = dispatch_command :projects
    keyboard = response.first[:reply_markup][:inline_keyboard]
    
    close_button_row = keyboard.last
    expect(close_button_row.size).to eq(1)
    expect(close_button_row.first[:text]).to eq('‚ùå –ó–∞–∫—Ä—ã—Ç—å')
    expect(close_button_row.first[:callback_data]).to eq('projects_close:')
  end
end
```

### 5.2. –†—É—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

| –®–∞–≥ | –î–µ–π—Å—Ç–≤–∏–µ | –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç |
|-----|----------|---------------------|
| 1 | –û—Ç–ø—Ä–∞–≤–∏—Ç—å `/projects` | –ü–æ—è–≤–ª—è–µ—Ç—Å—è –º–µ–Ω—é —Å –∫–Ω–æ–ø–∫–æ–π "‚ùå –ó–∞–∫—Ä—ã—Ç—å" |
| 2 | –ù–∞–∂–∞—Ç—å "‚ùå –ó–∞–∫—Ä—ã—Ç—å" | –°–æ–æ–±—â–µ–Ω–∏–µ —É–¥–∞–ª—è–µ—Ç—Å—è |
| 3 | –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å –º–æ–±–∏–ª—å–Ω–æ–≥–æ Telegram | –ö–Ω–æ–ø–∫–∞ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ |
| 4 | –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å Desktop Telegram | –ö–Ω–æ–ø–∫–∞ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ |

---

## 6. –û—Ü–µ–Ω–∫–∞ —Ä–∏—Å–∫–æ–≤

| –†–∏—Å–∫ | –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å | –í–ª–∏—è–Ω–∏–µ | –ú–∏—Ç–∏–≥–∞—Ü–∏—è |
|------|------------|---------|-----------|
| **R-1**: Telegram API rate limits | –ù–∏–∑–∫–∞—è | –°—Ä–µ–¥–Ω–µ–µ | –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `deleteMessage` (1 –∑–∞–ø—Ä–æ—Å) |
| **R-2**: –û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è —Å—Ç–∞—Ä–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è | –°—Ä–µ–¥–Ω—è—è | –ù–∏–∑–∫–æ–µ | Fallback –Ω–∞ `editMessage` |
| **R-3**: –°–ª–æ–º–∞—Ç—å callback routing | –ù–∏–∑–∫–∞—è | –í—ã—Å–æ–∫–æ–µ | –†–µ–≥—Ä–µ—Å—Å–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã –Ω–∞ –≤—Å–µ callback-–∏ |
| **R-4**: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –Ω–µ –∑–∞–º–µ—Ç—è—Ç –∫–Ω–æ–ø–∫—É | –°—Ä–µ–¥–Ω—è—è | –ù–∏–∑–∫–æ–µ | –ò–∫–æ–Ω–∫–∞ ‚ùå , –∫–æ–Ω—Ç—Ä–∞—Å—Ç–Ω–∞—è –ø–æ–∑–∏—Ü–∏—è |

### 6.1. –°—Ç—Ä–∞—Ç–µ–≥–∏—è –æ—Ç–∫–∞—Ç–∞

```ruby
# –ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ wrong:
# 1. –£–¥–∞–ª–∏—Ç—å –º–µ—Ç–æ–¥ projects_close_callback_query
# 2. –£–¥–∞–ª–∏—Ç—å —Å—Ç—Ä–æ–∫—É —Å close_button –∏–∑ show_projects_list
# 3. –£–¥–∞–ª–∏—Ç—å –ø–µ—Ä–µ–≤–æ–¥ –∏–∑ ru.yml
```

–í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω—ã –∏ –ª–µ–≥–∫–æ –æ—Ç–∫–∞—Ç—ã–≤–∞—é—Ç—Å—è.

---

## 7. –ú–µ—Ç—Ä–∏–∫–∏ –∏ KPI

| –ü–æ–∫–∞–∑–∞—Ç–µ–ª—å | –ë–∞–∑–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ | –¶–µ–ª—å | –ò–∑–º–µ—Ä–µ–Ω–∏–µ |
|------------|-----------------|------|-----------|
| –í—Ä–µ–º—è –æ—Ç–∫–ª–∏–∫–∞ | N/A | < 1s | NewRelic / Logs |
| –£—Å–ø–µ—à–Ω–æ—Å—Ç—å —É–¥–∞–ª–µ–Ω–∏—è | N/A | > 95% | Bugsnag |
| –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–µ —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–µ–Ω–∏–µ | N/A | > 4.5/5 | –û–ø—Ä–æ—Å—ã |

---

## 8. –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å –∏ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

### 8.1. –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –æ–∫—Ä—É–∂–µ–Ω–∏—é

- Ruby 3.x
- Rails 7.x
- telegram-bot-ruby gem (v0.16.7)
- –ü—Ä–∞–≤–∞ –±–æ—Ç–∞ –Ω–∞ `deleteMessage`

### 8.2. –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å | –ü—Ä–∏–º–µ—á–∞–Ω–∏—è |
|-----------|---------------|------------|
| Mobile Telegram | ‚úÖ 100% | –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ –Ω–∞ iOS/Android |
| Desktop Telegram | ‚úÖ 100% | –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ –Ω–∞ Win/Mac/Linux |
| Web Telegram | ‚úÖ 100% | –ë–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π |
| –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ callback-–∏ | ‚úÖ 100% | –ù–µ–∑–∞—Ç—Ä–æ–Ω—É—Ç—ã |
| –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å | ‚úÖ –ü–æ–ª–Ω–∞—è | –ù–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å |

---

## 9. –ü–ª–∞–Ω —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### 9.1. –≠—Ç–∞–ø—ã —Ä–∞–±–æ—Ç—ã

1. **–§–∞–∑–∞ 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞** (5 –º–∏–Ω)
   - –î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–µ–≤–æ–¥ `close_button` –≤ `config/locales/ru.yml`
   - –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è

2. **–§–∞–∑–∞ 2: –†–µ–∞–ª–∏–∑–∞—Ü–∏—è** (15 –º–∏–Ω)
   - –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç–æ–¥ `projects_close_callback_query`
   - –î–æ–±–∞–≤–∏—Ç—å –∫–Ω–æ–ø–∫—É –≤ `show_projects_list`
   - –û–±—Ä–∞–±–æ—Ç–∞—Ç—å –æ—à–∏–±–∫–∏ —É–¥–∞–ª–µ–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏—è

3. **–§–∞–∑–∞ 3: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** (10 –º–∏–Ω)
   - –ù–∞–ø–∏—Å–∞—Ç—å unit —Ç–µ—Å—Ç—ã
   - –ü—Ä–æ–≤–µ—Å—Ç–∏ —Ä—É—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ callback-—ã

4. **–§–∞–∑–∞ 4: –î–µ–ø–ª–æ–π** (5 –º–∏–Ω)
   - –ó–∞–º–µ—Ä–¥–∂–∏—Ç—å PR
   - –ó–∞–¥–µ–ø–ª–æ–∏—Ç—å –≤ production
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –Ω–∞ –æ—à–∏–±–∫–∏

### 9.2. –í—Ä–µ–º–µ–Ω–Ω–∞—è –æ—Ü–µ–Ω–∫–∞

| –≠—Ç–∞–ø | –û–ø—Ç–∏–º–∏—Å—Ç–∏—á–Ω–æ | –†–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ | –ü–µ—Å—Å–∏–º–∏—Å—Ç–∏—á–Ω–æ |
|------|-------------|-------------|---------------|
| –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ | 3 –º–∏–Ω | 5 –º–∏–Ω | 10 –º–∏–Ω |
| –†–µ–∞–ª–∏–∑–∞—Ü–∏—è | 10 –º–∏–Ω | 15 –º–∏–Ω | 25 –º–∏–Ω |
| –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ | 5 –º–∏–Ω | 10 –º–∏–Ω | 20 –º–∏–Ω |
| –î–µ–ø–ª–æ–π | 3 –º–∏–Ω | 5 –º–∏–Ω | 10 –º–∏–Ω |
| **–ò—Ç–æ–≥–æ** | **21 –º–∏–Ω** | **35 –º–∏–Ω** | **65 –º–∏–Ω** |

---

## 10. –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è

### 10.1. –í–∞—Ä–∏–∞–Ω—Ç A: –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –≤–º–µ—Å—Ç–æ —É–¥–∞–ª–µ–Ω–∏—è

```ruby
def projects_close_callback_query(_data = nil)
  edit_message :text,
    text: "üìã –ú–µ–Ω—é –ø—Ä–æ–µ–∫—Ç–æ–≤ –∑–∞–∫—Ä—ã—Ç–æ",
    reply_markup: { inline_keyboard: [] }
end
```

**–ü–ª—é—Å—ã**: Fallback —Ä–∞–±–æ—Ç–∞–µ—Ç –≤—Å–µ–≥–¥–∞  
**–ú–∏–Ω—É—Å—ã**: –ó–∞—Ö–ª–∞–º–ª—è–µ—Ç —á–∞—Ç

### 10.2. –í–∞—Ä–∏–∞–Ω—Ç B: –ö–Ω–æ–ø–∫–∞ "–ù–∞–∑–∞–¥" –≤–º–µ—Å—Ç–æ "–ó–∞–∫—Ä—ã—Ç—å"

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é –∫–Ω–æ–ø–∫—É "‚óÄÔ∏è –ù–∞–∑–∞–¥ –∫ —Å–ø–∏—Å–∫—É", –Ω–æ –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –≥–ª–∞–≤–Ω–æ–≥–æ –º–µ–Ω—é –æ–Ω–∞ –Ω–µ –∏–º–µ–µ—Ç —Å–º—ã—Å–ª–∞.

**–í–µ—Ä–¥–∏–∫—Ç**: –í–∞—Ä–∏–∞–Ω—Ç A —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω —á–∞—Å—Ç–∏—á–Ω–æ –∫–∞–∫ fallback, –æ—Å–Ω–æ–≤–Ω–æ–π –≤–∞—Ä–∏–∞–Ω—Ç - —É–¥–∞–ª–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è.

---

## 11. –í—ã–≤–æ–¥—ã –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### 11.1. –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π –ø–æ–¥—Ö–æ–¥

**–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –≤–∞—Ä–∏–∞–Ω—Ç "–£–¥–∞–ª–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è"** —Å fallback –Ω–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ, —Ç–∞–∫ –∫–∞–∫:

- ‚úÖ –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç UX –æ–∂–∏–¥–∞–Ω–∏—è–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- ‚úÖ –ú–∏–Ω–∏–º–∞–ª–∏—Å—Ç–∏—á–Ω–æ –∏ –Ω–µ –∑–∞—Ö–ª–∞–º–ª—è–µ—Ç —á–∞—Ç
- ‚úÖ –°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –∫–æ–¥–∞
- ‚úÖ –õ–µ–≥–∫–æ –æ—Ç–∫–∞—Ç—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏

### 11.2. –ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏–µ–º–∫–∏ (Definition of Done)

- [ ] –ö–Ω–æ–ø–∫–∞ "‚ùå –ó–∞–∫—Ä—ã—Ç—å" –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤ –º–µ–Ω—é `/projects`
- [ ] –ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ —É–¥–∞–ª—è–µ—Ç—Å—è —Å –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å—é > 95%
- [ ] –ü—Ä–∏ –æ—à–∏–±–∫–µ —É–¥–∞–ª–µ–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ—Ç—Å—è –Ω–∞ "–ú–µ–Ω—é –∑–∞–∫—Ä—ã—Ç–æ"
- [ ] –í—Å–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ callback-—ã —Ä–∞–±–æ—Ç–∞—é—Ç –±–µ–∑ —Ä–µ–≥—Ä–µ—Å—Å–∏–∏
- [ ] Unit —Ç–µ—Å—Ç—ã –ø–æ–∫—Ä—ã–≤–∞—é—Ç –Ω–æ–≤—É—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
- [ ] –†—É—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–π–¥–µ–Ω–æ –Ω–∞ –≤—Å–µ—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞—Ö Telegram

---

## 12. –†–∞–±–æ—á–∏–π –ø—Ä–æ—Ü–µ—Å—Å —Å git worktree

### 12.1. –°–æ–∑–¥–∞–Ω–∏–µ —Ä–∞–±–æ—á–µ–π –æ–±–ª–∞—Å—Ç–∏

–î–ª—è –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ —Ñ–∏—á–∏ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `git worktree`, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏–º–µ—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–±–æ—á–∏—Ö –∫–æ–ø–∏–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è —Å –æ–¥–Ω–æ–π –≤–µ—Ç–∫–æ–π:

```bash
# 1. –ü–µ—Ä–µ–π—Ç–∏ –≤ –æ—Å–Ω–æ–≤–Ω—É—é –ø–∞–ø–∫—É –ø—Ä–æ–µ–∫—Ç–∞
cd /home/danil/code/mashtime.ru

# 2. –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –≤–µ—Ç–∫—É –∏ —Ä–∞–±–æ—á—É—é –æ–±–ª–∞—Å—Ç—å
git worktree add -b feature/add-close-button-to-projects ~/code/mashtime-projects-close main

# 3. –ü–µ—Ä–µ–π—Ç–∏ –≤ –ø–∞–ø–∫—É –Ω–æ–≤–æ–π —Ä–∞–±–æ—á–µ–π –æ–±–ª–∞—Å—Ç–∏
cd ~/code/mashtime-projects-close

# 4. –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –Ω–∞—Ö–æ–¥–∏–º—Å—è –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –ø–∞–ø–∫–µ –∏ –≤–µ—Ç–∫–µ
pwd
# –í—ã–≤–æ–¥: /home/danil/code/mashtime-projects-close

git branch --show-current
# –í—ã–≤–æ–¥: feature/add-close-button-to-projects

git status
# –í—ã–≤–æ–¥: On branch feature/add-close-button-to-projects
```

### 12.2. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–∞—Ç–∞–ª–æ–≥–æ–≤

```
~/code/
‚îú‚îÄ‚îÄ mashtime.ru/                    # –û—Å–Ω–æ–≤–Ω–∞—è —Ä–∞–±–æ—á–∞—è –∫–æ–ø–∏—è (main)
‚îú‚îÄ‚îÄ mashtime-projects-close/        # –†–∞–±–æ—á–∞—è –∫–æ–ø–∏—è –¥–ª—è —Ñ–∏—á–∏
‚îÇ   ‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îú‚îÄ‚îÄ config/
‚îÇ   ‚îú‚îÄ‚îÄ spec/
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îî‚îÄ‚îÄ ...–¥—Ä—É–≥–∏–µ –≤–µ—Ç–∫–∏...
```

### 12.3. –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è worktree

| –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ | –û–ø–∏—Å–∞–Ω–∏–µ |
|--------------|----------|
| **–ò–∑–æ–ª—è—Ü–∏—è** | –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –æ–¥–Ω–æ–π —Ä–∞–±–æ—á–µ–π –æ–±–ª–∞—Å—Ç–∏ –Ω–µ –≤–ª–∏—è—é—Ç –Ω–∞ –¥—Ä—É–≥–∏–µ |
| **–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞** | –ú–æ–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–∞–¥ –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ —Ñ–∏—á–∞–º–∏ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ |
| **–ë—ã—Å—Ç—Ä–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ** | –ù–µ –Ω—É–∂–Ω–æ –¥–µ–ª–∞—Ç—å `git stash` –∏–ª–∏ –∫–æ–º–º–∏—Ç–∏—Ç—å WIP |
| **–ü—Ä–æ—Å—Ç–æ—Ç–∞ CI** | –ö–∞–∂–¥–∞—è —Ä–∞–±–æ—á–∞—è –æ–±–ª–∞—Å—Ç—å - —ç—Ç–æ –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π –∫–∞—Ç–∞–ª–æ–≥ –¥–ª—è —Ç–µ—Å—Ç–æ–≤ |

### 12.4. –°–æ–≤–º–µ—Å—Ç–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å –≤–µ—Ç–∫–∞–º–∏

```bash
# –í –æ—Å–Ω–æ–≤–Ω–æ–π –ø–∞–ø–∫–µ: –ø—Ä–æ–¥–æ–ª–∂–∞—Ç—å —Ä–∞–±–æ—Ç—É –Ω–∞–¥ –¥—Ä—É–≥–∏–º–∏ –∑–∞–¥–∞—á–∞–º–∏
cd /home/danil/code/mashtime.ru
git status
# –ù–∞ –≤–µ—Ç–∫–µ main, –Ω–∏–∫–∞–∫–∏—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π –æ—Ç feature/add-close-button-to-projects

# –í —Ä–∞–±–æ—á–µ–π –ø–∞–ø–∫–µ: —Ä–µ–∞–ª–∏–∑–æ–≤—ã–≤–∞—Ç—å —Ñ–∏—á—É
cd ~/code/mashtime-projects-close
# –í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω—ã –≤ —ç—Ç–æ–π –ø–∞–ø–∫–µ

# –ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ä–∞–±–æ—Ç—ã: —É–¥–∞–ª–∏—Ç—å —Ä–∞–±–æ—á—É—é –æ–±–ª–∞—Å—Ç—å
cd /home/danil/code/mashtime.ru
git worktree remove ~/code/mashtime-projects-close
# –í–µ—Ç–∫–∞ feature/add-close-button-to-projects —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è
```

### 12.5. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º —Ä–∞–±–æ—Ç—ã

–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–æ–±–∞–≤–∏—Ç—å –≤ `~/.bashrc` –∏–ª–∏ `~/.zshrc` –∞–ª–∏–∞—Å –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏:

```bash
alias wtstatus='echo "–¢–µ–∫—É—â–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è: $(pwd)" && echo "Git –≤–µ—Ç–∫–∞: $(git branch --show-current 2>/dev/null || echo "Not a git repo")"'
```

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:
```bash
cd ~/code/mashtime-projects-close
wtstatus
# –¢–µ–∫—É—â–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è: /home/danil/code/mashtime-projects-close
# Git –≤–µ—Ç–∫–∞: feature/add-close-button-to-projects
```

---

**–°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è –≥–æ—Ç–æ–≤–∞ –∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏. –í—Å–µ –¥–µ—Ç–∞–ª–∏ –ø—Ä–æ—Ä–∞–±–æ—Ç–∞–Ω—ã, —Ä–∏—Å–∫–∏ —É—á—Ç–µ–Ω—ã, —Ç–µ—Å—Ç–æ–≤—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω—ã. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ git worktree –æ–±–µ—Å–ø–µ—á–∏—Ç –±–µ–∑–æ–ø–∞—Å–Ω—É—é –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—É—é —Ä–∞–∑—Ä–∞–±–æ—Ç–∫—É —Ñ–∏—á–∏.**
