# –ü–ª–∞–Ω –º–∏–≥—Ä–∞—Ü–∏–∏ —Å Factory Bot –Ω–∞ Fixtures

## üìä –ê–ù–ê–õ–ò–ó –¢–ï–ö–£–©–ï–ì–û –°–û–°–¢–û–Ø–ù–ò–Ø

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Factory Bot
- **Gemfile**: `factory_bot_rails` –≤ test –≥—Ä—É–ø–ø–µ (—Å—Ç—Ä–æ–∫–∞ 171)
- **spec_helper.rb**: —Å—Ç—Ä–æ–∫–∏ 28, 91 (require –∏ include FactoryBot)
- **–§–∞–π–ª—ã —Å factory**: 11 —Ñ–∞–π–ª–æ–≤ –≤ spec/factories/
- **–ê–∫—Ç–∏–≤–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ**: 9 —Ç–µ—Å—Ç–æ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤ –∏—Å–ø–æ–ª—å–∑—É—é—Ç create/build –º–µ—Ç–æ–¥—ã

### –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ Fixtures
‚úÖ **–ò–º–µ—é—Ç—Å—è**: users.yml, projects.yml, memberships.yml, clients.yml, telegram_users.yml, time_shifts.yml, member_rates.yml
‚ùå **–û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç**: authentications.yml, invites.yml, admin_users.yml, notified_versions.yml, roles.yml, telegram_sessions.yml

### –ú–æ–¥–µ–ª–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (12 –º–æ–¥–µ–ª–µ–π)
```
authentication      - ‚ùå –Ω–µ—Ç fixture
client             - ‚úÖ –µ—Å—Ç—å fixture
invite             - ‚ùå –Ω–µ—Ç fixture
member_rate        - ‚úÖ –µ—Å—Ç—å fixture
membership         - ‚úÖ –µ—Å—Ç—å fixture
notified_version   - ‚ùå –Ω–µ—Ç fixture
project            - ‚úÖ –µ—Å—Ç—å fixture
role               - ‚ùå –Ω–µ—Ç fixture
telegram_session   - ‚ùå –Ω–µ—Ç fixture
telegram_user      - ‚úÖ –µ—Å—Ç—å fixture
time_shift         - ‚úÖ –µ—Å—Ç—å fixture
user               - ‚úÖ –µ—Å—Ç—å fixture
```

## üéØ –ö–†–ò–¢–ï–†–ò–ò –£–°–ü–ï–•–ê
1. –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç –±–µ–∑ –æ—à–∏–±–æ–∫
2. Gem `factory_bot_rails` —É–¥–∞–ª–µ–Ω –∏–∑ Gemfile
3. –í—Å–µ factory —Ñ–∞–π–ª—ã —É–¥–∞–ª–µ–Ω—ã
4. –í—Å–µ —Ç–µ—Å—Ç—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Ç–æ–ª—å–∫–æ fixtures

## üìã –ü–û–®–ê–ì–û–í–´–ô –ü–õ–ê–ù –ú–ò–ì–†–ê–¶–ò–ò

### –≠—Ç–∞–ø 0: –£—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø–ª–∞–Ω–∞ (–†–∞—Å—á–µ—Ç: 5 –º–∏–Ω—É—Ç)
0.1 –ü–æ–ª—É—á–∏—Ç—å —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø–ª–∞–Ω–∞ –º–∏–≥—Ä–∞—Ü–∏–∏ –æ—Ç —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞
0.2 –°–æ–∑–¥–∞—Ç—å backup —Ç–µ–∫—É—â–∏—Ö —Ç–µ—Å—Ç–æ–≤ –∏ fixtures
0.3 –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ —Ç–µ—Å—Ç–æ–≤—ã–π –Ω–∞–±–æ—Ä —Å–µ–π—á–∞—Å –ø—Ä–æ—Ö–æ–¥–∏—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é

### –≠—Ç–∞–ø 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ (–†–∞—Å—á–µ—Ç: 15 –º–∏–Ω—É—Ç)
1.1 –°–æ–∑–¥–∞—Ç—å –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–µ fixtures –¥–ª—è 6 –º–æ–¥–µ–ª–µ–π
- `authentications.yml` - –¥–ª—è OAuth –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- `invites.yml` - –¥–ª—è –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–π –≤ –ø—Ä–æ–µ–∫—Ç—ã
- `admin_users.yml` - –¥–ª—è –∞–¥–º–∏–Ω—Å–∫–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–µ—Å–ª–∏ –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –æ—Ç users)
- `notified_versions.yml` - –¥–ª—è –≤–µ—Ä—Å–∏–π —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- `roles.yml` - –¥–ª—è —Ä–æ–ª–µ–π –≤ —Å–∏—Å—Ç–µ–º–µ
- `telegram_sessions.yml` - –¥–ª—è —Å–µ—Å—Å–∏–π —Ç–µ–ª–µ–≥—Ä–∞–º

1.2 –†–∞—Å—à–∏—Ä–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ fixtures –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
- –î–æ–±–∞–≤–∏—Ç—å —Å–≤—è–∑–∏ –¥–ª—è –∞—Å—Å–æ—Ü–∏–∞—Ü–∏–π
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–ª–Ω–æ—Ç—É –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤

### –≠—Ç–∞–ø 2: –ú–∏–≥—Ä–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤ (–†–∞—Å—á–µ—Ç: 45 –º–∏–Ω—É—Ç)
2.1 –û–±–Ω–æ–≤–∏—Ç—å —Ç–µ—Å—Ç—ã —Å –ø—Ä—è–º—ã–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º factory –º–µ—Ç–æ–¥–æ–≤
- `spec/controllers/telegram/webhook/hours_command_spec.rb`
- `spec/support/shared_contexts/telegram_webhook_updated.rb`
- `spec/fixtures/simple_fixture_test.rb`

2.2 –ó–∞–º–µ–Ω–∏—Ç—å factory –≤—ã–∑–æ–≤—ã –Ω–∞ fixtures
- `create(:user)` ‚Üí `users(:regular_user)` –∏–ª–∏ `users(:admin)`
- `create(:project)` ‚Üí `projects(:work_project)`
- `create(:membership)` ‚Üí `memberships(:owner_membership)`

2.3 –û–±–Ω–æ–≤–∏—Ç—å shared contexts
- `telegram_webhook_updated.rb` - –∑–∞–º–µ–Ω–∏—Ç—å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ
- `telegram_webhook_with_fixtures.rb` - —É–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç fixtures, –ø—Ä–æ–≤–µ—Ä–∏—Ç—å

### –≠—Ç–∞–ø 3: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ (–†–∞—Å—á–µ—Ç: 10 –º–∏–Ω—É—Ç)
3.1 –£–¥–∞–ª–∏—Ç—å Factory Bot –∏–∑ spec_helper.rb
- –£–¥–∞–ª–∏—Ç—å —Å—Ç—Ä–æ–∫—É 28: `require 'factory_bot_rails'`
- –£–¥–∞–ª–∏—Ç—å —Å—Ç—Ä–æ–∫—É 91: `config.include FactoryBot::Syntax::Methods`

3.2 –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ fixtures
- –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ `config.global_fixtures = :all` –≤–∫–ª—é—á–µ–Ω
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å `config.use_transactional_fixtures = true`

### –≠—Ç–∞–ø 4: –û—á–∏—Å—Ç–∫–∞ (–†–∞—Å—á–µ—Ç: 10 –º–∏–Ω—É—Ç)
4.1 –£–¥–∞–ª–∏—Ç—å factory —Ñ–∞–π–ª—ã
- –£–¥–∞–ª–∏—Ç—å –≤—Å–µ 11 —Ñ–∞–π–ª–æ–≤ –≤ `spec/factories/`

4.2 –£–¥–∞–ª–∏—Ç—å gem –∏–∑ Gemfile
- –£–¥–∞–ª–∏—Ç—å —Å—Ç—Ä–æ–∫—É 171: `gem 'factory_bot_rails'`

4.3 –û–±–Ω–æ–≤–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–µ helper'—ã
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ shared contexts –Ω–∞ –ø—Ä–µ–¥–º–µ—Ç –æ—Ç—Å—ã–ª–æ–∫ –∫ factory

### –≠—Ç–∞–ø 5: –í–∞–ª–∏–¥–∞—Ü–∏—è (–†–∞—Å—á–µ—Ç: 20 –º–∏–Ω—É—Ç)
5.1 –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø–æ–ª–Ω—ã–π —Ç–µ—Å—Ç–æ–≤—ã–π –Ω–∞–±–æ—Ä
- `./bin/rails db:test:prepare test test:system`

5.2 –ò—Å–ø—Ä–∞–≤–∏—Ç—å –æ—à–∏–±–∫–∏ –µ—Å–ª–∏ –ø–æ—è–≤—è—Ç—Å—è
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ fixture –¥–∞–Ω–Ω—ã–µ
- –ò—Å–ø—Ä–∞–≤–∏—Ç—å —Å–≤—è–∑–∏ –º–µ–∂–¥—É fixtures

5.3 –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
- –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ –≤—Å–µ 190+ —Ç–µ—Å—Ç–æ–≤ –ø—Ä–æ—Ö–æ–¥—è—Ç
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–∫–æ—Ä–æ—Å—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ç–µ—Å—Ç–æ–≤

## üîß –¢–ï–•–ù–ò–ß–ï–°–ö–ò–ï –î–ï–¢–ê–õ–ò

### –°–æ–∑–¥–∞–Ω–∏–µ –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏—Ö fixtures

**authentications.yml**:
```yaml
github_auth:
  user: regular_user
  provider: github
  uid: '123456'
  token: 'test_token'
  secret: 'test_secret'
```

**invites.yml**:
```yaml
pending_invite:
  email: invite@example.com
  project: work_project
  inviter: admin
  role: participant
  token: 'invite_token'
```

**roles.yml**:
```yaml
owner_role:
  name: owner
  description: –ü–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ –ø—Ä–æ–µ–∫—Ç—É

participant_role:
  name: participant
  description: –£—á–∞—Å—Ç–Ω–∏–∫ –ø—Ä–æ–µ–∫—Ç–∞
```

### –®–∞–±–ª–æ–Ω—ã –∑–∞–º–µ–Ω—ã factory ‚Üí fixtures

| Factory –≤—ã–∑–æ–≤ | Fixture –∑–∞–º–µ–Ω–∞ |
|---------------|----------------|
| `create(:user)` | `users(:regular_user)` |
| `create(:user, :admin)` | `users(:admin)` |
| `create(:project, name: 'Test')` | `projects(:work_project)` |
| `create(:membership, user:, project:, role: 'owner')` | `memberships(:owner_membership)` |

## ‚ö†Ô∏è –†–ò–°–ö–ò –ò –ú–ò–¢–ò–ì–ê–¶–ò–Ø

### –†–∏—Å–∫–∏:
1. **–°–ª–æ–∂–Ω—ã–µ factory –∞—Å—Å–æ—Ü–∏–∞—Ü–∏–∏** - –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ factories –º–æ–≥—É—Ç –∏–º–µ—Ç—å —Å–ª–æ–∂–Ω—É—é –ª–æ–≥–∏–∫—É —Å–æ–∑–¥–∞–Ω–∏—è
2. **–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ** - factories –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ, fixtures —Å—Ç–∞—Ç–∏—á–Ω—ã
3. **–¢–µ—Å—Ç—ã –∑–∞–≤–∏—Å—è—â–∏–µ –æ—Ç factory –∫–æ–ª–±—ç–∫–æ–≤** - –º–æ–≥—É—Ç —Å–ª–æ–º–∞—Ç—å—Å—è –ø—Ä–∏ –º–∏–≥—Ä–∞—Ü–∏–∏

### –ú–∏—Ç–∏–≥–∞—Ü–∏—è:
1. **–ü–æ—ç—Ç–∞–ø–Ω–∞—è –º–∏–≥—Ä–∞—Ü–∏—è** - –º–µ–Ω—è—Ç—å –æ–¥–∏–Ω —Ç–µ—Å—Ç –∑–∞ —Ä–∞–∑ —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π
2. **–†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ fixtures** - —Å–æ–∑–¥–∞–≤–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
3. **–í–∞–ª–∏–¥–∞—Ü–∏—è –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ —ç—Ç–∞–ø–∞** - –∑–∞–ø—É—Å–∫–∞—Ç—å —Ç–µ—Å—Ç—ã –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–π –≥—Ä—É–ø–ø—ã –∏–∑–º–µ–Ω–µ–Ω–∏–π

## üìà –û–ñ–ò–î–ê–ï–ú–´–ï –†–ï–ó–£–õ–¨–¢–ê–¢–´

- **–£–ø—Ä–æ—â–µ–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤–æ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã** (–º–µ–Ω—å—à–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π)
- **–£—Å–∫–æ—Ä–µ–Ω–∏–µ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–µ—Å—Ç–æ–≤** (fixtures –±—ã—Å—Ç—Ä–µ–µ factories)
- **–ë–æ–ª–µ–µ –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º—ã–µ —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ** (—Å—Ç–∞—Ç–∏—á–Ω—ã–µ fixtures)
- **–°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –ø—Ä–∞–≤–∏–ª–∞–º –ø—Ä–æ–µ–∫—Ç–∞** (–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å fixtures, –∞ –Ω–µ factories)

## ‚è∞ –í–†–ï–ú–ï–ù–ù–´–ï –ó–ê–¢–†–ê–¢–´
- **–≠—Ç–∞–ø 0**: 5 –º–∏–Ω—É—Ç
- **–≠—Ç–∞–ø 1**: 15 –º–∏–Ω—É—Ç
- **–≠—Ç–∞–ø 2**: 45 –º–∏–Ω—É—Ç
- **–≠—Ç–∞–ø 3**: 10 –º–∏–Ω—É—Ç
- **–≠—Ç–∞–ø 4**: 10 –º–∏–Ω—É—Ç
- **–≠—Ç–∞–ø 5**: 20 –º–∏–Ω—É—Ç
- **–ò—Ç–æ–≥–æ**: ~1.5-2 —á–∞—Å–∞

## üéØ –§–ò–ù–ê–õ–¨–ù–ê–Ø –ü–†–û–í–ï–†–ö–ê –ö–ê–ß–ï–°–¢–í–ê
–ü–æ—Å–ª–µ –º–∏–≥—Ä–∞—Ü–∏–∏ —É–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ:
- [ ] –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç (`bundle exec rspec` - –∑–µ–ª–µ–Ω—ã–π)
- [ ] `factory_bot_rails` —É–¥–∞–ª–µ–Ω –∏–∑ Gemfile
- [ ] –ü–∞–ø–∫–∞ `spec/factories/` –ø—É—Å—Ç–∞ –∏–ª–∏ —É–¥–∞–ª–µ–Ω–∞
- [ ] –ù–µ—Ç —É–ø–æ–º–∏–Ω–∞–Ω–∏–π FactoryBot –≤ –∫–æ–¥–µ
- [ ] –§–∏–∫—Å—Ç—É—Ä—ã —Å–æ–¥–µ—Ä–∂–∞—Ç –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–∞–Ω–Ω—ã–µ
- [ ] –°–∫–æ—Ä–æ—Å—Ç—å —Ç–µ—Å—Ç–æ–≤ –Ω–µ —É—Ö—É–¥—à–∏–ª–∞—Å—å (–∏–ª–∏ —É–ª—É—á—à–∏–ª–∞—Å—å)