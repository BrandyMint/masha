# –¢–ó: –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∫–æ–º–∞–Ω–¥—ã /edit –¥–ª—è Telegram –±–æ—Ç–∞

## –û–±–∑–æ—Ä

–ù–µ–æ–±—Ö–æ–¥–∏–º–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∫–æ–º–∞–Ω–¥—É `/edit` –¥–ª—è Telegram –±–æ—Ç–∞ Masha, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–∑–≤–æ–ª–∏—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–Ω–µ–µ –≤–Ω–µ—Å–µ–Ω–Ω—ã–µ –∑–∞–ø–∏—Å–∏ –æ –≤—Ä–µ–º–µ–Ω–∏.

## –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

### –û—Å–Ω–æ–≤–Ω–æ–π —Å—Ü–µ–Ω–∞—Ä–∏–π –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

1. **–ü—Ä–æ—Å–º–æ—Ç—Ä –∑–∞–ø–∏—Å–µ–π**: –ü—Ä–∏ –≤–≤–æ–¥–µ –∫–æ–º–∞–Ω–¥—ã `/edit` –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–µ 50 —Å–≤–æ–∏—Ö –∑–∞–ø–∏—Å–µ–π –≤—Ä–µ–º–µ–Ω–∏
2. **–í—ã–±–æ—Ä –∑–∞–ø–∏—Å–∏**: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±–∏—Ä–∞–µ—Ç ID –∑–∞–ø–∏—Å–∏ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
3. **–í—ã–±–æ—Ä –ø–æ–ª—è**: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±–∏—Ä–∞–µ—Ç, —á—Ç–æ –∏–º–µ–Ω–Ω–æ —Ö–æ—á–µ—Ç –∏–∑–º–µ–Ω–∏—Ç—å:
   - –ü—Ä–æ–µ–∫—Ç
   - –ß–∞—Å—ã
   - –û–ø–∏—Å–∞–Ω–∏–µ
4. **–í–≤–æ–¥ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö**: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ–¥–∏—Ç –Ω–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
5. **–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ**: –°–∏—Å—Ç–µ–º–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–µ–≤—å—é –∏–∑–º–µ–Ω–µ–Ω–∏–π –∏ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ
6. **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ**: –ò–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—é

#### –°–ø–∏—Å–æ–∫ –∑–∞–ø–∏—Å–µ–π (—à–∞–≥ 1)
- –§–æ—Ä–º–∞—Ç: `ID | –î–∞—Ç–∞ | –ü—Ä–æ–µ–∫—Ç | –ß–∞—Å—ã | –û–ø–∏—Å–∞–Ω–∏–µ`
- –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞: –ø–æ —É–±—ã–≤–∞–Ω–∏—é –¥–∞—Ç—ã (—Å–Ω–∞—á–∞–ª–∞ –Ω–æ–≤—ã–µ)
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ: 50 –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –∑–∞–ø–∏—Å–µ–π
- –ï—Å–ª–∏ –∑–∞–ø–∏—Å–µ–π –Ω–µ—Ç - —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –¥–∞–Ω–Ω—ã—Ö

#### –í—ã–±–æ—Ä –ø–æ–ª—è –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (—à–∞–≥ 3)
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å inline –∫–Ω–æ–ø–∫–∏ –¥–ª—è –≤—ã–±–æ—Ä–∞ –ø–æ–ª—è
- –ö–Ω–æ–ø–∫–∏: "üìÅ –ü—Ä–æ–µ–∫—Ç", "‚è∞ –ß–∞—Å—ã", "üìù –û–ø–∏—Å–∞–Ω–∏–µ", "‚ùå –û—Ç–º–µ–Ω–∞"

#### –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π (—à–∞–≥ 5)
- –ü–æ–∫–∞–∑–∞—Ç—å —Ç–µ–∫—É—â–∏–µ –∏ –Ω–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
- –ö–Ω–æ–ø–∫–∏: "‚úÖ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å", "‚ùå –û—Ç–º–µ–Ω–∞"

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

- **–ö–æ–º–∞–Ω–¥–∞**: `app/controllers/telegram/commands/edit_command.rb`
- **–°–µ—Ä–≤–∏—Å**: `app/services/telegram_time_editor.rb`
- **–ö–æ–Ω—Ç–µ–∫—Å—Ç**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å session –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### –ú–æ–¥–µ–ª—å –¥–∞–Ω–Ω—ã—Ö

**TimeShift** (—É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç):
- `id` - —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∑–∞–ø–∏—Å–∏
- `user_id` - ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `project_id` - ID –ø—Ä–æ–µ–∫—Ç–∞
- `hours` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —á–∞—Å–æ–≤
- `date` - –¥–∞—Ç–∞
- `description` - –æ–ø–∏—Å–∞–Ω–∏–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

### States –≤ session

```ruby
session[:edit_context] = {
  time_shift_id: integer,
  editing_field: string, # 'project', 'hours', 'description'
  new_value: mixed,
  original_values: hash
}
```

### –í–∞–ª–∏–¥–∞—Ü–∏—è

1. **–ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞**: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ –∑–∞–ø–∏—Å–∏
2. **–í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö**:
   - –ü—Ä–æ–µ–∫—Ç: –¥–æ–ª–∂–µ–Ω —Å—É—â–µ—Å—Ç–≤–æ–≤–∞—Ç—å –∏ –±—ã—Ç—å –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
   - –ß–∞—Å—ã: —á–∏—Å–ª–æ >= 0.1
   - –û–ø–∏—Å–∞–Ω–∏–µ: —Ç–µ–∫—Å—Ç –¥–æ 1000 —Å–∏–º–≤–æ–ª–æ–≤
3. **–í—Ä–µ–º—è**: –î–∞—Ç–∞ –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –≤ –±—É–¥—É—â–µ–º

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

- –ó–∞–ø–∏—Å—å –Ω–µ –Ω–∞–π–¥–µ–Ω–∞
- –ù–µ—Ç –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞
- –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π ID
- –û—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
- –ü—Ä–µ–≤—ã—à–µ–Ω–∏–µ –ª–∏–º–∏—Ç–∞ –≤—Ä–µ–º–µ–Ω–∏ —Å–µ—Å—Å–∏–∏

## UX —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

### –ù–∞–≤–∏–≥–∞—Ü–∏—è

- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ—Ç–º–µ–Ω—ã –Ω–∞ –ª—é–±–æ–º —ç—Ç–∞–ø–µ
- –ö–Ω–æ–ø–∫–∞ "–ù–∞–∑–∞–¥" –¥–ª—è –≤–æ–∑–≤—Ä–∞—Ç–∞ –∫ –ø—Ä–µ–¥—ã–¥—É—â–µ–º—É —à–∞–≥—É
- –¢–∞–π–º–∞—É—Ç —Å–µ—Å—Å–∏–∏: 5 –º–∏–Ω—É—Ç –±–µ–∑–¥–µ–π—Å—Ç–≤–∏—è

### –°–æ–æ–±—â–µ–Ω–∏—è

- –î—Ä—É–∂–µ–ª—é–±–Ω—ã–µ –∏ –ø–æ–Ω—è—Ç–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
- –ü–æ–¥—Å–∫–∞–∑–∫–∏ –ø–æ —Ñ–æ—Ä–º–∞—Ç—É –¥–∞–Ω–Ω—ã—Ö
- –Ø—Å–Ω—ã–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã —Ç–µ–∫—É—â–µ–≥–æ —à–∞–≥–∞

### Inline –∫–Ω–æ–ø–∫–∏

- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å emoji –¥–ª—è –≤–∏–∑—É–∞–ª—å–Ω–æ–≥–æ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è
- –õ–æ–≥–∏—á–Ω–∞—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –¥–µ–π—Å—Ç–≤–∏–π
- –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π —Ä–∞–∑–º–µ—Ä –∫–Ω–æ–ø–æ–∫

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º –∫–æ–¥–æ–º

### –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

- `BaseCommand` - –±–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å –∫–æ–º–∞–Ω–¥
- `TelegramHelpers` - —Ö–µ–ª–ø–µ—Ä—ã Telegram
- `TelegramCallbacks` - –æ–±—Ä–∞–±–æ—Ç–∫–∞ callback'–æ–≤
- `Authority` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞

### –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

- –†–∞–±–æ—Ç–∞—Ç—å —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π —Å–∏—Å—Ç–µ–º–æ–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø—Ä–æ–µ–∫—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –°–ª–µ–¥–æ–≤–∞—Ç—å existing patterns –≤ –∫–æ–¥–µ

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### Unit —Ç–µ—Å—Ç—ã

- `EditCommand` - –ª–æ–≥–∏–∫–∞ –∫–æ–º–∞–Ω–¥—ã
- `TelegramTimeEditor` - —Å–µ—Ä–≤–∏—Å —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

### Integration —Ç–µ—Å—Ç—ã

- –ü–æ–ª–Ω—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- –†–∞–±–æ—Ç–∞ —Å session
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Telegram API

### –¢–µ—Å—Ç–æ–≤—ã–µ —Å–ª—É—á–∞–∏

1. **Happy path**: —É—Å–ø–µ—à–Ω–æ–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –ø–æ–ª–µ–π
2. **–û—Ç–º–µ–Ω–∞**: –æ—Ç–º–µ–Ω–∞ –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —ç—Ç–∞–ø–∞—Ö
3. **–û—à–∏–±–∫–∏**: –Ω–µ–≤–µ—Ä–Ω—ã–π ID, –Ω–µ—Ç –ø—Ä–∞–≤, –≤–∞–ª–∏–¥–∞—Ü–∏—è
4. **Edge cases**: –ø—É—Å—Ç–æ–π —Å–ø–∏—Å–æ–∫, —Ç–∞–π–º–∞—É—Ç —Å–µ—Å—Å–∏–∏

## Deploy —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

- –ú–∏–≥—Ä–∞—Ü–∏–∏ –Ω–µ —Ç—Ä–µ–±—É—é—Ç—Å—è (–∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ç–∞–±–ª–∏—Ü—ã)
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –∫–æ–º–∞–Ω–¥ `/help`
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–π —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –æ—à–∏–±–æ–∫ —á–µ—Ä–µ–∑ Bugsnag

## Success –∫—Ä–∏—Ç–µ—Ä–∏–∏

- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–≤–æ–∏ –∑–∞–ø–∏—Å–∏ –≤—Ä–µ–º–µ–Ω–∏
- –ü—Ä–æ—Ü–µ—Å—Å –∏–Ω—Ç—É–∏—Ç–∏–≤–Ω–æ –ø–æ–Ω—è—Ç–Ω—ã–π (–º–µ–Ω–µ–µ 3 –º–∏–Ω—É—Ç –Ω–∞ –æ–ø–µ—Ä–∞—Ü–∏—é)
- –í—Å–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –æ—à–∏–±–æ–∫ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- –¢–µ—Å—Ç—ã –ø–æ–∫—Ä—ã–≤–∞—é—Ç >90% –∫–æ–¥–∞
- –ù–µ—Ç –Ω–µ–≥–∞—Ç–∏–≤–Ω–æ–≥–æ –≤–ª–∏—è–Ω–∏—è –Ω–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª